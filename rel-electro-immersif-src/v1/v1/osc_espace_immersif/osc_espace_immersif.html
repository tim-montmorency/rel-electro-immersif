<!DOCTYPE HTML>
<html lang="fr" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Objectif final</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
            <link rel="stylesheet" href="../glightbox/dist/css/glightbox.min.css" />
           <script src="../glightbox/dist/js/glightbox.min.js"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../couverture.html"><strong aria-hidden="true">1.</strong> Couverture</a></li><li class="chapter-item expanded "><a href="../rel-electro-immersif.html"><strong aria-hidden="true">2.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../osc_espace_immersif/osc_espace_immersif.html" class="active"><strong aria-hidden="true">3.</strong> Objectif final</a></li><li class="chapter-item expanded affix "><li class="part-title">Électronique</li><li class="chapter-item expanded "><a href="../electricite/electricite.html"><strong aria-hidden="true">4.</strong> Électricité</a></li><li class="chapter-item expanded "><a href="../schemas_circuits/schemas_circuits.html"><strong aria-hidden="true">5.</strong> Schémas de circuit</a></li><li class="chapter-item expanded "><a href="../platine_experimentation/platine_experimentation.html"><strong aria-hidden="true">6.</strong> Platine d'expérimentation</a></li><li class="chapter-item expanded "><a href="../erreurs_fatales/erreurs_fatales.html"><strong aria-hidden="true">7.</strong> Erreurs fatales</a></li><li class="chapter-item expanded "><a href="../del/del.html"><strong aria-hidden="true">8.</strong> DEL</a></li><li class="chapter-item expanded "><a href="../resistance/resistance.html"><strong aria-hidden="true">9.</strong> Résistance</a></li><li class="chapter-item expanded "><a href="../alimenter_del/alimenter_del.html"><strong aria-hidden="true">10.</strong> Alimenter une DEL</a></li><li class="chapter-item expanded "><a href="../micro-soudure/micro-soudure.html"><strong aria-hidden="true">11.</strong> Micro-soudure</a></li><li class="chapter-item expanded "><a href="../multimetre/multimetre.html"><strong aria-hidden="true">12.</strong> Multimètre</a></li><li class="chapter-item expanded affix "><li class="part-title">Cartes Arduino</li><li class="chapter-item expanded "><a href="../arduino_cartes/arduino_cartes.html"><strong aria-hidden="true">13.</strong> Modèles de cartes</a></li><li class="chapter-item expanded "><a href="../arduino_nano/arduino_nano.html"><strong aria-hidden="true">14.</strong> Cartes Arduino Nano</a></li><li class="chapter-item expanded affix "><li class="part-title">Arduino IDE</li><li class="chapter-item expanded "><a href="../arduino-ide/fenetre_principale.html"><strong aria-hidden="true">15.</strong> Fenêtre principale</a></li><li class="chapter-item expanded "><a href="../arduino-ide_configuration_nano/arduino-ide_configuration_nano.html"><strong aria-hidden="true">16.</strong> Configuration du port</a></li><li class="chapter-item expanded "><a href="../arduino-ide_test_blink/arduino-ide_test_blink.html"><strong aria-hidden="true">17.</strong> Blink: le code test universel</a></li><li class="chapter-item expanded affix "><li class="part-title">Algorithmie I</li><li class="chapter-item expanded "><a href="../arduino_code/arduino_code.html"><strong aria-hidden="true">18.</strong> Le code Arduino</a></li><li class="chapter-item expanded "><a href="../arduino_millis/arduino_millis.html"><strong aria-hidden="true">19.</strong> Mesurer le temps</a></li><li class="chapter-item expanded "><a href="../intervalle/intervalle.html"><strong aria-hidden="true">20.</strong> Intervalle de temps</a></li><li class="chapter-item expanded affix "><li class="part-title">Les sorties numériques</li><li class="chapter-item expanded "><a href="../sortie_numerique/sortie_numerique.html"><strong aria-hidden="true">21.</strong> Sortie numérique</a></li><li class="chapter-item expanded "><a href="../arduino_exemple_del/arduino_exemple_del.html"><strong aria-hidden="true">22.</strong> Contrôle d'une DEL</a></li><li class="chapter-item expanded affix "><li class="part-title">Algorithmie II</li><li class="chapter-item expanded "><a href="../arduino_deboguer/arduino_deboguer.html"><strong aria-hidden="true">23.</strong> Déboguage série ASCII</a></li><li class="chapter-item expanded affix "><li class="part-title">Les entrées numériques</li><li class="chapter-item expanded "><a href="../entree_numerique/entree_numerique.html"><strong aria-hidden="true">24.</strong> Entrée numérique</a></li><li class="chapter-item expanded "><a href="../interrupteur/interrupteur.html"><strong aria-hidden="true">25.</strong> Interrupteur</a></li><li class="chapter-item expanded "><a href="../bouton_poussoir/bouton_poussoir.html"><strong aria-hidden="true">26.</strong> Bouton poussoir</a></li><li class="chapter-item expanded "><a href="../bouton_arcade/bouton_arcade.html"><strong aria-hidden="true">27.</strong> Bouton d'arcade</a></li><li class="chapter-item expanded affix "><li class="part-title">Algorithmie III</li><li class="chapter-item expanded "><a href="../changement/changement.html"><strong aria-hidden="true">28.</strong> Changement de valeur</a></li><li class="chapter-item expanded "><a href="../envoi_optimal_de_valeur/envoi_optimal_de_valeur.html"><strong aria-hidden="true">29.</strong> Envoi optimal de valeur</a></li><li class="chapter-item expanded affix "><li class="part-title">Les entrées analogiques</li><li class="chapter-item expanded "><a href="../entree_analogique/entree_analogique.html"><strong aria-hidden="true">30.</strong> Entrée analogique</a></li><li class="chapter-item expanded "><a href="../potentiometre/potentiometre.html"><strong aria-hidden="true">31.</strong> Potentiomètre</a></li><li class="chapter-item expanded "><a href="../photoresistance/photoresistance.html"><strong aria-hidden="true">32.</strong> Photorésistance</a></li><li class="chapter-item expanded affix "><li class="part-title">Les sorties analogiques</li><li class="chapter-item expanded "><a href="../sortie_analogique/sortie_analogique.html"><strong aria-hidden="true">33.</strong> Sortie analogique</a></li><li class="chapter-item expanded "><a href="../chandelle/chandelle.html"><strong aria-hidden="true">34.</strong> Simuler une chandelle</a></li><li class="chapter-item expanded affix "><li class="part-title">OSC</li><li class="chapter-item expanded "><a href="../osc/osc.html"><strong aria-hidden="true">35.</strong> Open Sound Control (OSC)</a></li><li class="chapter-item expanded "><a href="../microosc/microosc.html"><strong aria-hidden="true">36.</strong> MicroOsc</a></li><li class="chapter-item expanded "><a href="../osc_slip/osc_slip.html"><strong aria-hidden="true">37.</strong> OSC SLIP avec MicroOsc</a></li><li class="chapter-item expanded affix "><li class="part-title">OSC SLIP</li><li class="chapter-item expanded "><a href="../pd/osc_slip.html"><strong aria-hidden="true">38.</strong> OSC SLIP : Pure Data (PD)</a></li><li class="chapter-item expanded "><a href="../max/max_osc_slip.html"><strong aria-hidden="true">39.</strong> OSC SLIP : Cycling '74 Max</a></li><li class="chapter-item expanded "><a href="../osc_slip_web/osc_slip_web.html"><strong aria-hidden="true">40.</strong> OSC SLIP : Web/Node.js</a></li><li class="chapter-item expanded affix "><li class="part-title">OSC UDP</li><li class="chapter-item expanded "><a href="../pd/relais_osc_slip_udp.html"><strong aria-hidden="true">41.</strong> Relais SLIP⇄UDP avec PD</a></li><li class="chapter-item expanded "><a href="../max/relais_osc_slip_udp.html"><strong aria-hidden="true">42.</strong> Relais SLIP⇄UDP avec Max</a></li><li class="chapter-item expanded "><a href="../pd/pd_osc_udp.html"><strong aria-hidden="true">43.</strong> OSC UDP : Pure Data</a></li><li class="chapter-item expanded "><a href="../max/max_osc_udp.html"><strong aria-hidden="true">44.</strong> OSC UDP : Cycling '74 Max</a></li><li class="chapter-item expanded "><a href="../vcv_rack/vcv_rack_osc.html"><strong aria-hidden="true">45.</strong> OSC UDP : VCV Rack</a></li><li class="chapter-item expanded "><a href="../osc_udp_unity/osc_udp_unity.html"><strong aria-hidden="true">46.</strong> OSC UDP : Unity</a></li><li class="chapter-item expanded "><a href="../touchdesigner/td_osc_udp.html"><strong aria-hidden="true">47.</strong> OSC UDP : TouchDesigner</a></li><li class="chapter-item expanded affix "><li class="part-title">Les bandes de DEL</li><li class="chapter-item expanded "><a href="../bande_del/bande_del.html"><strong aria-hidden="true">48.</strong> Bande de DEL</a></li><li class="chapter-item expanded "><a href="../pong_1d/pong_1d.html"><strong aria-hidden="true">49.</strong> Pong 1D</a></li><li class="chapter-item expanded "><a href="../bande_del_osc/bande_del_osc.html"><strong aria-hidden="true">50.</strong> Contrôle par OSC</a></li><li class="chapter-item expanded affix "><li class="part-title">Déploiement</li><li class="chapter-item expanded "><a href="../raspberry_pi/raspberry_pi.html"><strong aria-hidden="true">51.</strong> Raspberry PI</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <div id="ToC"></div>
                        <h1 id="objectif-final"><a class="header" href="#objectif-final">Objectif final</a></h1>
<h2 id="description-de-lobjectif-final"><a class="header" href="#description-de-lobjectif-final">Description de l'objectif final</a></h2>
<p>Toute la matière de cette REL a été choisie et ordonnée pour diriger l'apprenant dans la réalisation d'un objectif final. Cet objectif est présenté ici, tout au début, pour donner un sens, une direction et une présentation de l'étendue des savoirs contenus dans cette ressource.</p>
<p><img src="./integration_electro_espace.png" alt="Comment intégrer l'électronique à un espace immersif?" /></p>
<p>Cette REL propose une solution pour l'intégration de l'électronique aux espaces immersifs dans un contexte de création multimédia. C'est-à-dire l’intégration de capteurs et actionneurs dans un grand espace où l'ordinateur multimédia, qui doit coordonner les aspects audiovisuels (les projections visuelles, les éclairages, les effets et les diffusions sonores), est distant. </p>
<p>La solution proposée essaie de rester peu onéreuse et accessible tout en demeurant fiable (en éliminant les sources d’erreurs potentielles des communications) et très compatible avec les outils de création multimédia.</p>
<p>À cette fin, l’environnement de développement choisi est Arduino IDE, le modèle de carte l’Arduino Nano et le protocole de communication l’Open Sound Control (OSC).</p>
<p>À noter que cette documentation est entièrement compatible avec des cartes qui communiquent par Wi-Fi ou par Ethernet comme les cartes équipées d'ESP32. Les cartes Arduino ESP32 sont en effet à privilégier à long terme, mais elles sont plus difficiles à maitriser. Leur utilisation sera intégrée à cette ressource ultérieurement.</p>
<h2 id="connectique-osc-de-lobjectif-final"><a class="header" href="#connectique-osc-de-lobjectif-final">Connectique OSC de l'objectif final</a></h2>
<p>Le schéma suivant présente le système de connexion et de communication choisi :
<img src="./osc_espace_immersif_connectique.svg" alt="Connectique OSC pour un espace immersif" /></p>
<h2 id="circuit-électronique-de-lobjectif-final"><a class="header" href="#circuit-électronique-de-lobjectif-final">Circuit électronique de l'objectif final</a></h2>
<h3 id="illustration-du-circuit-électronique"><a class="header" href="#illustration-du-circuit-électronique">Illustration du circuit électronique</a></h3>
<p>L'illustration suivante présente le circuit que les étudiants devront réaliser pour l'intégration aux espaces immersifs :
<img src="./osc_espace_immersif_illustration.png" alt="Illustration du circuit pour l'intégration de l'électronique à un espace immersif" /></p>
<h3 id="schéma-du-circuit-éléctronique"><a class="header" href="#schéma-du-circuit-éléctronique">Schéma du circuit éléctronique</a></h3>
<p>De façon générale, les schémas de circuit seront privilégiés. Le schéma suivant représente le même circuit que l'illustration ci-haut :
<img src="./osc_espace_immersif_schema.png" alt="Schéma du circuit pour l'intégration de l'électronique à un espace immersif" /></p>
<h2 id="code-arduino-de-lobjectif-final"><a class="header" href="#code-arduino-de-lobjectif-final">Code Arduino de l'objectif final</a></h2>
<p>Pour assurer la connexion avec l’espace immersif, voici le code qui sera exécuté sur l’Arduino :</p>
<pre><code class="language-arduino">// MicroOsc_Demo_SLIP
// by Thomas O Fredericks
// 2023-02-20

// WHAT IS DOES
// ======================
// OSC communication example.
//
// OSC messages received by the Arduino :
// - /led int -&gt; turn off (0) or on (1) a LED 
// - /pwm int -&gt; set the pwm (0-255) of the arcade button LED 
//
// OSC messages sent by the Arduino :
// - /pot int -&gt; sends the value of a potentiometer 
// - /photo int -&gt; sends the value of a photocell
// - /button int -&gt; sends the value of a button

// HARDWARE REQUIREMENTS
// ==================
// - POTENTIOMETER connected to analog pin A0
// - POTOCELL (with voltage resistor) connected to analog pin A1
// - Illuminated arcade BUTTON with it's switch connected to pin 2
//   and it's LED connected to pin 3 (will be PWM modulated)
// - LED (and matching resistor) connected to pin 5 (will be turned off or on)

// REQUIRED LIBRARIES
// ==================
// - MicroOsc

// REQUIRED CONFIGURATION
// ======================
// - Set the baud of your computer's serial connection to 115200



#include &lt;MicroOscSlip.h&gt;

// THE NUMBER 64 BETWEEN THE &lt; &gt; SYMBOLS  BELOW IS THE MAXIMUM NUMBER OF BYTES RESERVED FOR INCOMMING MESSAGES.
// MAKE SURE THIS NUMBER OF BYTES CAN HOLD THE SIZE OF THE MESSAGE YOUR ARE RECEIVING IN ARDUINO.
// OUTGOING MESSAGES ARE WRITTEN DIRECTLY TO THE OUTPUT AND DO NOT NEED ANY RESERVED BYTES.
MicroOscSlip&lt;64&gt; myMicroOsc(&amp;Serial);  // CREATE AN INSTANCE OF MicroOsc FOR SLIP MESSAGES

unsigned long myChronoStart = 0;  // VARIABLE USED TO LIMIT THE SPEED OF THE loop() FUNCTION.

// POTENTIOMETER
int myPotPin = A0;
int myPotStoredValue = 0;

// PHOTOCELL
int myPhotoPin = A1;
int myPhotoStoredValue = 0;

// BUTTON
int myButtonPin = 2;
int myButtonSotredValue = 0;

// BUTON LED
int myButtonLedPin = 3;  // PIN MUST SUPPORT PWM

// LED
int myLedPin = 5;

/********
  SETUP
*********/
void setup() {
  Serial.begin(115200);                // START SERIAL COMMUNICATION
  pinMode(myPotPin, INPUT);            // POTENTIOMETER: ANALOG INPUT
  pinMode(myPhotoPin, INPUT);          // PHOTOCELL: ANALOG INPUT
  pinMode(myButtonPin, INPUT_PULLUP);  // BUTTON: DIGITAL INPUT
  pinMode(myButtonLedPin, OUTPUT);     // LED: DIGITAL OUTPUT
  pinMode(myLedPin, OUTPUT);           // LED: DIGITAL OUTPUT
}

/****************
  ON OSC MESSAGE
*****************/
void myOnOscMessageReceived(MicroOscMessage&amp; oscMessage) {
  
  if (oscMessage.checkOscAddress(&quot;/led&quot;)) {  // IF THE ADDRESS IS /led
    int newValue = oscMessage.nextAsInt();  // GET NEW VALUE AS INT
    digitalWrite(myLedPin, newValue);       // SET LED OUTPUT TO VALUE (DIGITAL: OFF/ON)
    
  } else if (oscMessage.checkOscAddress(&quot;/buttonLed&quot;)) {  // IF THE ADDRESS IS /buttonLed
    int newValue = oscMessage.nextAsInt();  // GET NEW VALUE AS INT
    analogWrite(myButtonLedPin, newValue);       // SET LED OUTPUT TO VALUE (ANALOG/PWM: 0-255)

  }
  
}

/****************
  POTENTIOMETER UPDATE
****************/
void myPotUpdateValueAndSendIfChanged() {
  int newValue = analogRead(myPotPin);             // READ NEW VALUE
  if (newValue != myPotStoredValue) {              // IF NEW VALUE DIFFERENT THAN STORED VALUE
    myPotStoredValue = newValue;                   // STORE NEW VALUE
    myMicroOsc.sendInt(&quot;/pot&quot;, myPotStoredValue);  // SEND UPDATED VALUE
  }
}

/*********************
  PHOTOCELL UPDATE
**********************/
void myPhotoUpdateValueAndSendIfChanged() {
  int newValue = analogRead(myPhotoPin);               // READ CURRENT VALUE
  if (newValue != myPhotoStoredValue) {                // IF NEW VALUE DIFFERENT THAN STORED VALUE
    myPhotoStoredValue = newValue;                     // STORE NEW VALUE
    myMicroOsc.sendInt(&quot;/photo&quot;, myPhotoStoredValue);  // SEND UPDATED VALUE
  }
}

/*********************
  BUTTON UPDATE
**********************/
void myButtonUpdateValueAndSendIfChanged() {
  int newValue = digitalRead(myButtonPin);               // READ CURRENT VALUE
  if (newValue != myButtonSotredValue) {                 // IF NEW VALUE DIFFERENT THAN STORED VALUE
    myButtonSotredValue = newValue;                      // STORE NEW VALUE
    myMicroOsc.sendInt(&quot;/button&quot;, myButtonSotredValue);  // SEND UPDATED VALUE
  }
}

/*******
  LOOP
********/
void loop() {

  myMicroOsc.onOscMessageReceived(myOnOscMessageReceived);  // TRIGGER OSC RECEPTION

  if (millis() - myChronoStart &gt;= 50) {  // IF 50 MS HAVE ELLAPSED
    myChronoStart = millis();            // RESTART CHRONO

    myPotUpdateValueAndSendIfChanged();  // POTENTIOMETER UPDATE

    myPhotoUpdateValueAndSendIfChanged();  // PHOTOCELL UPDATE

    myButtonUpdateValueAndSendIfChanged();  // BUTTON UPDATE
  }
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../rel-electro-immersif.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../electricite/electricite.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../rel-electro-immersif.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../electricite/electricite.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
         <script type="text/javascript">
              // LIGHT BOX FOR VIDEOS
              // https://github.com/biati-digital/glightbox
              const main = document.getElementsByTagName('main')[0];
              var collectionOrNodes = main.getElementsByTagName('a');
              var a = Array.prototype.slice.call( collectionOrNodes );
              //console.log("Elements in main: "+a.length);
              a.forEach(function(currentElement){ 
                
                if ( currentElement.href.includes("youtube.com") || currentElement.href.includes("vimeo.com" ) ) {
                    currentElement.classList.add("glightboxed")
                }
                
                 });


                    var lightbox = GLightbox({
                        selector: '.glightboxed',
                        touchNavigation: true,
                        loop: false,
                        autoplayVideos: false,
                    });
                    lightbox.on('open', (target) => {
                        console.log('lightbox opened');
                    });
          </script>

          <script type="text/javascript">
              function altTextToImageCaption() {
                  let imgs = document.getElementsByTagName('img');
                  for (var i = 0; i < imgs.length; i++) {
      
                    var att = imgs[i].attributes.getNamedItem('alt');
                    if (!att) continue;
                    var alt = att.value;
                    if (!alt) continue;
                    //if (!alt.startsWith('Fig ')) continue;
                    var cap = document.createElement('div');
                    cap.setAttribute('class', 'imageCaption');
                    cap.appendChild(document.createTextNode(alt));
                    //imgs[i].parentNode.insertBefore(cap, imgs[i].nextSibling);
                    let containerDiv =  document.createElement('div');
                    //containerDiv.style.backgroundColor ='white';
                    //containerDiv.style.justifyContent = 'center';
                     //containerDiv.style.display = 'inline';
                    containerDiv.style.textAlign = 'center';
                    imgs[i].parentNode.appendChild(containerDiv);
                    containerDiv.appendChild(imgs[i]);
                    containerDiv.appendChild(cap);

                  }
                }
                altTextToImageCaption();

                function externalLinksOpenBlank() {
                    var anchorEls = document.querySelectorAll('a');
                    var anchorElsLength = anchorEls.length;

                    for (var i = 0; i < anchorElsLength; i++) {
                        var anchorEl = anchorEls[i];
                        var href = anchorEl.getAttribute('href');

                        if (href.startsWith("http",0)) {
                          anchorEl.setAttribute('target', '_blank');
                        }
                    }
                }
                externalLinksOpenBlank();

                function buildToc() {
                    
                    let tagetList = document.getElementsByTagName("h1");

                                        // Get the h2 tags — ToC entries
                    let headers = document.getElementsByTagName("h2");
                    if ( headers.length < 2) return;
                    
                     
                    if (tagetList.length < 1) return
                    let target = null;
                    for (i =0; i<tagetList.length;i++){
                      
                        if ( tagetList[i].children.length > 0 ) {
                            
                            if ( tagetList[i].children[0].classList.contains("header")) {
                                target = tagetList[i];
                                
                                break;
                            }
                        }
                    }
                    if ( target == null) return;

                    // Create a list for the ToC entries
                    let tocList = document.createElement("ul"); 

                    // Add a begin if missing a first header
                    if ( !(target.nextElementSibling.tagName == "H2" || target.nextElementSibling.tagName == "h2") )   {
                        let tocListItem = document.createElement("li");    
                        let tocEntry = document.createElement("a");
                        
                        tocEntry.setAttribute("href","#");
                        tocEntry.innerText="Début";
                     
                        tocListItem.appendChild(tocEntry);
                        tocList.appendChild(tocListItem);
                    }
                    
                                         

                     

                     
                     // For each h3
                     for (i = 0; i < headers.length; i++){
                     
                        // Create an id
                        //name = "h"+i;
                        //headers[i].id=name;
                     
                        // a list item for the entry
                        let tocListItem = document.createElement("li");    
                        let tocEntry = document.createElement("a");
                        
                        tocEntry.setAttribute("href",headers[i].children[0].href);
                        tocEntry.innerText=headers[i].innerText;
                     
                        tocListItem.appendChild(tocEntry);
                        tocList.appendChild(tocListItem);
                     }
                     target.parentNode.insertBefore(tocList, target.nextSibling);
                     //toc.insertBefore(tocList);
                }
                buildToc();

                
          </script>

    </body>
</html>
